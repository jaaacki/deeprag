# =============================================================================
# EMBY PROCESSOR CONFIGURATION
# =============================================================================
# Copy this file to .env and update with your actual values

# -----------------------------------------------------------------------------
# Directories (Docker mount points)
# -----------------------------------------------------------------------------
WATCH_DIR=/watch
DESTINATION_DIR=/destination
UNPROCESSED_DIR=/watch/unprocessed

# -----------------------------------------------------------------------------
# Video Processing
# -----------------------------------------------------------------------------
# Comma-separated list of video file extensions to process
VIDEO_EXTENSIONS=.mp4,.mkv,.avi,.wmv

# File stability check settings (prevents processing while file is being written)
STABILITY_CHECK_INTERVAL=5    # Seconds between size checks
STABILITY_MIN_CHECKS=2        # Number of consecutive identical checks before processing

# -----------------------------------------------------------------------------
# WordPress REST API (emby-service plugin)
# -----------------------------------------------------------------------------
# Use Docker internal hostname when running in same network as WordPress
API_BASE_URL=http://wpfamilyhubid_nginx/wp-json/emby/v1
API_TOKEN=
API_SEARCH_ORDER=missav,javguru

# -----------------------------------------------------------------------------
# Emby Server Integration
# -----------------------------------------------------------------------------
# Use Docker container name (emby-processor connects to both networks)
# Container name: emby_server (from /volume3/docker/emby/compose.yaml)

# Production (Docker):
EMBY_BASE_URL=http://emby_server:8096

# Development (public URL for testing):
# EMBY_BASE_URL=https://emby.familyhub.id

# Get API key from: Emby Dashboard → Advanced → API Keys
EMBY_API_KEY=your-emby-api-key-here

# Server ID (find in Emby URL: serverId=xxx)
EMBY_SERVER_ID=your-server-id-here

# Library path as Emby sees it (for path translation)
# Our container sees /destination, but Emby server may see a different path
# Check your Emby docker-compose volumes to find the correct path
EMBY_LIBRARY_PATH=/mnt/media/jpv

# Optional: Specific library ID to scan (leave empty to scan all)
# Get library IDs: curl -H "X-Emby-Token: YOUR_KEY" http://emby:8096/Library/VirtualFolders
EMBY_LIBRARY_ID=

# Parent folder ID for the main video library (used for batch processing)
# This is the root folder containing all actress folders
# From legacy: ParentId=4
EMBY_PARENT_FOLDER_ID=4

# Enable/disable automatic library scan after moving files
EMBY_TRIGGER_SCAN=true

# Retry delays (comma-separated seconds) for polling Emby after scan
# Uses exponential backoff: tries immediately, then waits 2s, 4s, 8s, 16s, 32s, 64s
# Total max wait: ~126 seconds before giving up
EMBY_SCAN_RETRY_DELAYS=2,4,8,16,32,64

# -----------------------------------------------------------------------------
# PostgreSQL Queue Database
# -----------------------------------------------------------------------------
# Option 1: Full connection string
# DATABASE_URL=postgresql://emby:emby@localhost:5432/emby_processor

# Option 2: Individual parameters
DB_HOST=localhost
DB_PORT=5432
DB_NAME=emby_processor
DB_USER=emby
DB_PASSWORD=emby
